{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load tags %}

{% block title %}
    {% if user.company %}
        {{ user_view.company }}
    {% else %}
        {{ user_view.first_name }} {{ user_view.last_name }}
    {% endif %}
{% endblock %}

{% block content %}
    {% if not user_view.company %}
    
        <!-- APPLICANT -->
        <div class="header">
            <h2>{{ user_view.first_name }} {{ user_view.last_name }}
                {% if user == user_view %}
                    &ensp;<span>
                        <a href="{% url 'edit_personal' %}">
                            <img class="action-owner" src="{{ BADGES_URL }}edit.png" alt="Редактировать">
                            <!-- <input type="button" class="button button-blue" value="Edit"> -->
                        </a>
                    </span>
                {% endif %}
            </h2><hr>
        </div>

        <div class="oneline">
            <div class="avatar-applicant">
                {% if user_view.applicant.photo %}
                    <img src="{{user_view.applicant.photo.url}}" alt="avatar">
                {% else %}
                    <img src="{{ MEDIA_URL }}blank.png" alt="avatar">
                {% endif %}
            </div>

            <div class="property">
                {% if user_view.applicant.birthday %}
                    <p>Возраст:</p>
                    <!-- <p>Born: </p> -->
                {% endif %}

                <p>Почта:</p>

                {% if user_view.applicant.location %}
                    <p>Город:</p>
                {% endif %}

                {% if user_view.applicant.citizenship %}
                    <p>Гражданство: </p>
                {% endif %}
            </div>

            <div class="value">
                {% if user_view.applicant.birthday %}
                    <p>{{ user_view.applicant.birthday|timesince|only_first_period:',' }}</p>
                    <!-- <p>{{ user_view.applicant.birthday }}</p> -->
                {% endif %}

                <p><a class="link" href="mailto:{{ user_view.email }}">{{ user_view.email }}</a></p>

                {% if user_view.applicant.location %}
                    <p>{{ user_view.applicant.location }}</p>
                {% endif %}

                {% if user_view.applicant.citizenship %}
                    <p>{{ user_view.applicant.citizenship }}</p>
                {% endif %}
            </div>
        </div>

        {% if user == user_view %}
            <div class="change-avatar-applicant">
                <a href="{% url 'edit_photo' %}"><button class="button button-blue" type="submit">Сменить</button></a>
            </div>
        {% endif %}
        <!-- End -->

        <!-- Education -->
        {% if user == user_view %}
            <h4>Образование
                &ensp;<span>
                    <a href="{% url 'edit_education' %}">
                        <img class="action-owner" src="{{ BADGES_URL }}edit.png" alt="Редактировать">
                        <!-- <input type="button" class="button button-blue" value="Edit"> -->
                    </a>
                </span>
            </h4><hr>
            
            <div class="oneline">
                <div class="property">
                    {% if user_view.applicant.education %}
                        <p>Уровень: </p>
                    {% endif %}
                    
                    {% if user_view.applicant.specialization %}
                        <p>Специализация: </p>
                    {% endif %}
                </div>
                <div class="value">
                    {% if user_view.applicant.education %}
                        <p>{{ user_view.applicant.education }}</p>
                    {% endif %}

                    {% if user_view.applicant.specialization %}
                        <p>{{ user_view.applicant.specialization }}</p>
                    {% endif %}
                </div>
            </div>
        {% else %}
            {% if user_view.applicant.education %}
                <h4>Образование</h4><hr>
                <div class="oneline">
                    <div class="property">
                        {% if user_view.applicant.education %}
                            <p>Degree: </p>
                        {% endif %}
                        {% if user_view.applicant.specialization %}
                            <p>Specialization: </p>
                        {% endif %}
                    </div>
                    <div class="value">
                        {% if user_view.applicant.education %}
                            <p>{{ user_view.applicant.education }}</p>
                        {% endif %}
                
                        {% if user_view.applicant.specialization %}
                            <p>{{ user_view.applicant.specialization }}</p>
                        {% endif %}
                    </div>
                </div>
            {% endif %}
        {% endif %}
        <!-- End -->
    
        <!-- Experience -->
        {% if user_view.applicant.experience %}
            <h4>Опыт работы 
                {% if user == user_view %}
                    {% if not user_view.applicant.experience.first %}
                        &ensp;
                        <span>
                            <a href="{% url 'add_experience' %}">
                                <img class="action-owner" src="{{ BADGES_URL }}add.png" alt="Добавить">
                                <!-- <input type="button" class="button button-green" value="Add"> -->
                            </a>
                        </span>
                    {% else %}
                        &ensp;
                        <span>
                            <a href="{% url 'edit_experience' %}">
                                <img class="action-owner" src="{{ BADGES_URL }}edit.png" alt="Редактировать">
                                <!-- <input type="button" class="button button-blue" value="Edit"> -->
                            </a>
                        </span>
                    {% endif %}
                {% endif %}
            </h4><hr>
        
            {% for exp in user_view.applicant.experience.all %} 
                <div class="oneline">
                    <div class="property">
                        <p>С {{ exp.begin }}&ensp;&#8212;</p>
                        {% if exp.now %}
                            <p>по настоящее время</p>
                        {% else %}
                            <p>{{ exp.end }}</p>
                        {% endif %}
                        {% if user == user_view %}
                            <span>
                                <a href="{% url 'delete_experience' exp.id %}">
                                    <img class="action-owner" src="{{ BADGES_URL }}delete.png" alt="Удалить">
                                    <!-- <input type="button" class="button button-red" value="Delete"> -->
                                </a>
                            </span>
                        {% endif %}
                    </div>
                    <div class="value">
                        <p><b>{{ exp.company }}</p></b>
                        {% if exp.company_site %}
                            <p><a href="{{ exp.company_site }}">{{ exp.company_site }}</a></p>
                        {% endif %}
                        <p>{{ exp.company_spheres }}</p><br>
                        <p><b>{{ exp.position }}</p></b>
                        <pre>{{ exp.responsibilities }}</pre>
                    </div>
                </div><br>
                
                {% if user_view.applicant.experience.last != exp %}
                    <hr class="hr-grey">
                {% endif %}
            {% endfor %}
        {% endif %}
        <!-- End -->

        <!-- Skills -->
        {% if user == user_view %}
            <h4>Ключевые навыки
                &ensp;<span>
                    <a href="{% url 'edit_skills' %}">
                        <img class="action-owner" src="{{ BADGES_URL }}edit.png" alt="Редактировать">
                        <!-- <button type="button" class="button button-blue">Edit</button> -->
                    </a>
                </span>
            </h4><hr>

            <div class="value-without-property">
                {% if user_view.applicant.skills %}
                    <p>{{ user_view.applicant.skills }}</p>
                {% endif %}
            </div>
        {% else %}
            {% if user_view.applicant.skills %}
                <h4>Skills</h4><hr>
                <div class="value-without-property">
                    <p>{{ user_view.applicant.skills }}</p>
                </div>
            {% endif %}
        {% endif %}
        <!-- End -->

        <!-- Languages -->
        {% if user == user_view %}
            <h4>Знание языков 
                &ensp;<span>
                    <a href="{% url 'edit_languages' %}">
                        <img class="action-owner" src="{{ BADGES_URL }}edit.png" alt="Редактировать">
                         <!-- <input type="button" class="button button-blue" value="Edit"> -->
                    </a>
                </span>
            </h4><hr>
            
            <div class="value-without-property">
                {% if user_view.applicant.languages %}
                    <p>{{ user_view.applicant.languages }}</p>
                {% endif %}
            </div>
        {% else %}
            {% if user_view.applicant.languages %}
                <h4>Languages</h4><hr>
                <div class="value-without-property">
                    <p>{{ user_view.applicant.languages }}</p>
                </div>
            {% endif %}
        {% endif %}
        <!-- End -->
    
    {% else %}

        <!-- EMPLOYER -->
        <div class="header">
            <h2>{{ user_view.company }}
            {% if user == user_view %}
                &ensp;<span>
                    <a href="{% url 'edit_personal' %}">
                        <img class="action-owner" src="{{ BADGES_URL }}edit.png" alt="Edit">
                        <!-- <input type="button" class="button button-blue" value="Edit"></a> -->
                </span>
            {% endif %}
            </h2><hr>
        </div>

        {% if user_view.employer.photo %}
            <div class="avatar-company">
                <img src="{{user_view.employer.photo.url}} " alt="company-logo">
            </div>
        {% else %}
            <div class="avatar-company">
                <img src="{{ MEDIA_URL }}blank-company.png" alt="company-logo">
            </div>  
        {% endif %}

        {% if user == user_view %}
            <div class="center">
                <a href="{% url 'edit_photo' %}">
                    <input type="button" class="button button-blue" value="Сменить">
                </a>
            </div>
        {% endif %}
    <!-- End -->

    <!-- About -->
        {% if user_view.employer.company_info %}
            <h4>About</h4><hr>
            <div class="value-without-property">
                {{ user_view.employer.company_info|safe }}
            </div>
        {% endif %}
    <!-- End -->

    <!-- Contacts -->
        {% if user_view.employer.company_site or user_view.employer.company_email %}
            <h4>Contacts</h4><hr>
            {% if user_view.employer.company_site %}
                <div class="oneline">
                    <div class="property">
                        <p>Web site:</p>  
                    </div> 
                    <div class="value">
                        <p><a class="link" href="{{ user_view.employer.company_site }}">{{ user_view.employer.company_site }}</a></p>
                    </div>
                </div>
            {% endif%}
       
            {% if user_view.employer.company_email %}
                <div class="oneline">
                    <div class="property">
                        <p>Email:</p>
                    </div>
                    <div class="value">
                        <a href="mailto:{{ user_view.employer.company_email }}">{{ user_view.employer.company_email }}</a>
                    </div>
                </div>
            {% endif%}
        {% endif%}
    <!-- End -->
        
    <!-- Vacancies -->
        {% if user != user_view %}
            <h4>Company vacancies</h4><hr>
            {% if vacancies %}
                <p class="indent-first-line">Vacancies: {{ vacancies.count }}</p>
                {% for vacancy in vacancies %}
                    <div class="value-without-property">
                        <p><a class="link vacancy-link" href="{% url 'vacancy_detail' vacancy.id %}">{{ vacancy.position }}</a></p>
                    </div>
                {% endfor %}
            {% else %}
                {% if user != user_view %}
                    <div class="value-without-property">
                        At the moment the {{ user_view.employer }} has no vacancies.
                    </div>
                {% endif %}
            {% endif %}
        {% endif%}
    <!-- End -->

    {% endif%}
{% endblock %}